

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Concept and Workflow &mdash; KIWI NG 10.2.42 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=222806a2"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Host Requirements To Build Images" href="concept_and_workflow/systemdeps.html" />
    <link rel="prev" title="Building based on Containers" href="plugins/stackbuild.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            KIWI NG
              <img src="_static/kiwi-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview/workflow.html">Basic Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/workflow.html#components-of-an-image-description">Components of an Image Description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#conceptual-overview">Conceptual Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#terminology">Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#system-requirements">System Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-from-obs">Installation from OBS</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-from-distribution-repositories">Installation from Distribution Repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#example-appliance-descriptions">Example Appliance Descriptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#before-you-start">Before you start</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#choose-a-first-image">Choose a First Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#build-your-first-image">Build your First Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#run-your-image">Run your Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#tweak-and-customize-your-image">Tweak and Customize your Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Working from the Command Line</a><ul>
<li class="toctree-l2"><a class="reference internal" href="commands/kiwi.html">kiwi-ng</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#global-options">GLOBAL OPTIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#example">EXAMPLE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/result_list.html">kiwi-ng result list</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/result_list.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/result_list.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/result_list.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/result_bundle.html">kiwi-ng result bundle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/result_bundle.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/result_bundle.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/result_bundle.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/system_prepare.html">kiwi-ng system prepare</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/system_prepare.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_prepare.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_prepare.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/system_update.html">kiwi-ng system update</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/system_update.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_update.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_update.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/system_build.html">kiwi-ng system build</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/system_build.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_build.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_build.html#options">OPTIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_build.html#uri-types">URI_TYPES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/system_create.html">kiwi-ng system create</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/system_create.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_create.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_create.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/image_resize.html">kiwi-ng image resize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/image_resize.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/image_resize.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/image_resize.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/image_info.html">kiwi-ng image info</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/image_info.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/image_info.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/image_info.html#options">OPTIONS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/buildhost_constraints.html">Build Host Constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting/buildhost_constraints.html#package-manager-behavior">Package Manager Behavior</a><ul>
<li class="toctree-l4"><a class="reference internal" href="troubleshooting/buildhost_constraints.html#zypper-modalias-matching">zypper: modalias matching</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/architectures.html">Architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/security.html">Host Security Settings Conflicts with KIWI</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/filesystems.html">Incompatible Filesystem Settings on Host vs. Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/boxbuild_tweaks.html">Boxbuild Tweaks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting/boxbuild_tweaks.html#increase-box-build-image-size">Increase Box Build Image Size</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">KIWI Plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plugins/self_contained.html">Building in a Self-Contained Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/self_contained.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/self_contained.html#building-with-the-boxbuild-command">Building with the boxbuild command</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/self_contained.html#sharing-backends">Sharing Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/self_contained.html#building-in-container">Building in Container</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins/stackbuild.html">Building based on Containers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/stackbuild.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/stackbuild.html#concept">Concept</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/stackbuild.html#create-a-stash">Create a stash</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/stackbuild.html#rebuild-from-a-stash">Rebuild from a stash</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/stackbuild.html#turn-a-container-into-a-vm-image">Turn a container into a VM image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Concept and Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="concept_and_workflow/systemdeps.html">Host Requirements To Build Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="concept_and_workflow/repository_setup.html">Setting up Repositories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/repository_setup.html#adding-repositories">Adding repositories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="concept_and_workflow/repository_setup.html#supported-repository-paths">Supported repository paths</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concept_and_workflow/packages.html">Adding and Removing Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/packages.html#the-package-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">package</span></code> element</a></li>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/packages.html#the-archive-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">archive</span></code> element</a></li>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/packages.html#uninstall-system-packages">Uninstall System Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/packages.html#the-product-and-namedcollection-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">product</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">namedCollection</span></code> element</a></li>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/packages.html#the-ignore-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">ignore</span></code> element</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concept_and_workflow/profiles.html">Image Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="concept_and_workflow/users.html">Adding Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="concept_and_workflow/shell_scripts.html">User-Defined Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/shell_scripts.html#developing-debugging-scripts">Developing/Debugging Scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="concept_and_workflow/shell_scripts.html#script-template-for-config-sh-images-sh">Script Template for config.sh / images.sh</a></li>
<li class="toctree-l4"><a class="reference internal" href="concept_and_workflow/shell_scripts.html#functions-and-variables-provided-by-kiwi-ng">Functions and Variables Provided by KIWI NG</a></li>
<li class="toctree-l4"><a class="reference internal" href="concept_and_workflow/shell_scripts.html#configuration-tips">Configuration Tips</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concept_and_workflow/runtime_configuration.html">The Runtime Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="concept_and_workflow/customize_the_boot_process.html">Customizing the Boot Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/customize_the_boot_process.html#boot-image-hook-scripts">Boot Image Hook-Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="concept_and_workflow/customize_the_boot_process.html#boot-image-parameters">Boot Image Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="concept_and_workflow/customize_the_boot_process.html#boot-debugging">Boot Debugging</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#image-building-process">Image Building Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-prepare-step">The Prepare Step</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-create-step">The Create Step</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="image_description.html">Image Description</a><ul>
<li class="toctree-l2"><a class="reference internal" href="image_description/elements.html">Image Description Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#image">&lt;image&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#include">&lt;include&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#description">&lt;description&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#certificates">&lt;certificates&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#preferences">&lt;preferences&gt;</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-version">&lt;preferences&gt;&lt;version&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-packagemanager">&lt;preferences&gt;&lt;packagemanager&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-rpm-locale-filtering">&lt;preferences&gt;&lt;rpm-locale-filtering&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-rpm-check-signatures">&lt;preferences&gt;&lt;rpm-check-signatures&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-rpm-excludedocs">&lt;preferences&gt;&lt;rpm-excludedocs&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-keytable">&lt;preferences&gt;&lt;keytable&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-timezone">&lt;preferences&gt;&lt;timezone&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-locale">&lt;preferences&gt;&lt;locale&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-bootsplash-theme">&lt;preferences&gt;&lt;bootsplash-theme&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-bootloader-theme">&lt;preferences&gt;&lt;bootloader-theme&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-release-version">&lt;preferences&gt;&lt;release-version&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type">&lt;preferences&gt;&lt;type&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-luksformat">&lt;preferences&gt;&lt;type&gt;&lt;luksformat&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-bootloader">&lt;preferences&gt;&lt;type&gt;&lt;bootloader&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-bootloader-securelinux">&lt;preferences&gt;&lt;type&gt;&lt;bootloader&gt;&lt;securelinux&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-bootloader-bootloadersettings">&lt;preferences&gt;&lt;type&gt;&lt;bootloader&gt;&lt;bootloadersettings&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-containerconfig">&lt;preferences&gt;&lt;type&gt;&lt;containerconfig&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-vagrantconfig">&lt;preferences&gt;&lt;type&gt;&lt;vagrantconfig&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-systemdisk">&lt;preferences&gt;&lt;type&gt;&lt;systemdisk&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-partitions">&lt;preferences&gt;&lt;type&gt;&lt;partitions&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-oemconfig">&lt;preferences&gt;&lt;type&gt;&lt;oemconfig&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-size">&lt;preferences&gt;&lt;type&gt;&lt;size&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-machine">&lt;preferences&gt;&lt;type&gt;&lt;machine&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-installmedia">&lt;preferences&gt;&lt;type&gt;&lt;installmedia&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#preferences-type-initrd">&lt;preferences&gt;&lt;type&gt;&lt;initrd&gt;</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#containers">&lt;containers&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#containers-container">&lt;containers&gt;&lt;container&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#repository">&lt;repository&gt;</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#repository-source">&lt;repository&gt;&lt;source&gt;</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#packages">&lt;packages&gt;</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#packages-package">&lt;packages&gt;&lt;package&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#packages-namedcollection">&lt;packages&gt;&lt;namedCollection&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#packages-collectionmodule">&lt;packages&gt;&lt;collectionModule&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#packages-file">&lt;packages&gt;&lt;file&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#packages-archive">&lt;packages&gt;&lt;archive&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#packages-ignore">&lt;packages&gt;&lt;ignore&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_description/elements.html#packages-product">&lt;packages&gt;&lt;product&gt;</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#users">&lt;users&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="image_description/elements.html#profiles">&lt;profiles&gt;</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="image_description.html#main-root">Main Root</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_description.html#image-identity">Image Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_description.html#image-preferences">Image Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_description.html#image-software-sources">Image Software Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_description.html#image-content-setup">Image Content Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_description.html#image-users">Image Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_description.html#image-namespace">Image Namespace</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_description.html#image-includes">Image Includes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="image_types_and_results.html">Image Types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="image_types_and_results.html#image-results">Image Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_types_and_results.html#image-bundle-format">Image Bundle Format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="building_images.html">Building Images for Supported Types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="building_images/build_live_iso.html">Build an ISO Hybrid Live Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_live_iso.html#overlay-or-dmsquash"><code class="xref py py-obj docutils literal notranslate"><span class="pre">overlay</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">dmsquash</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building_images/build_simple_disk.html">Build a Virtual Disk Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_simple_disk.html#setting-up-the-bootloader-in-the-image">Setting up the Bootloader in the Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_simple_disk.html#modifying-the-size-of-the-image">Modifying the Size of the Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_simple_disk.html#customizing-the-virtual-machine">Customizing the Virtual Machine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="building_images/build_simple_disk.html#modifying-the-vm-configuration-directly">Modifying the VM Configuration Directly</a></li>
<li class="toctree-l4"><a class="reference internal" href="building_images/build_simple_disk.html#adding-network-interfaces-to-the-vm">Adding Network Interfaces to the VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="building_images/build_simple_disk.html#specifying-disks-and-disk-controllers">Specifying Disks and Disk Controllers</a></li>
<li class="toctree-l4"><a class="reference internal" href="building_images/build_simple_disk.html#adding-cd-dvd-drives">Adding CD/DVD Drives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building_images/build_expandable_disk.html">Build an Expandable Disk Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_expandable_disk.html#deployment-methods">Deployment Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_expandable_disk.html#manual-deployment">Manual Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_expandable_disk.html#cd-dvd-deployment">CD/DVD Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_expandable_disk.html#network-deployment">Network Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_expandable_disk.html#oem-customization">OEM Customization</a></li>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_expandable_disk.html#installation-media-customization">Installation Media Customization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building_images/build_container_image.html">Build a Container Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="building_images/build_wsl_container.html">Build a WSL Container Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_wsl_container.html#setup-of-the-wsl-distrolauncher">Setup of the WSL-DistroLauncher</a></li>
<li class="toctree-l3"><a class="reference internal" href="building_images/build_wsl_container.html#testing-the-wsl-image">Testing the WSL image</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building_images/build_kis.html">Build KIS Image (Kernel, Initrd, System)</a></li>
<li class="toctree-l2"><a class="reference internal" href="building_images/build_enclave.html">Build an AWS Nitro Enclave</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="working_with_images.html">Working with Images</a><ul>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/iso_to_usb_stick_deployment.html">Deploy ISO Image on a USB Stick</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/iso_to_usb_stick_file_based_deployment.html">Deploy ISO Image as a File on a FAT32 Formatted USB Stick</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/iso_to_usb_stick_grub2_boot_from_iso.html">Booting Live ISO Images from Grub2</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/disk_setup_for_ec2.html">Image Description for Amazon EC2</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/disk_setup_for_azure.html">Image Description for Microsoft Azure</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/disk_setup_for_google.html">Image Description for Google Compute Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/disk_setup_for_vagrant.html">Image Description for Vagrant</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/disk_setup_for_vagrant.html#customizing-the-embedded-vagrantfile">Customizing the embedded Vagrantfile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/disk_setup_for_luks.html">Image Description for an Encrypted Disk</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/disk_ramdisk_deployment.html">Deploy and Run a System in a Ramdisk</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/custom_partitions.html">Custom Disk Partitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/custom_volumes.html">Custom Disk Volumes</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/clone_partitions.html">Partition Clones</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/clone_partitions.html#use-case">Use Case</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/setup_network_bootserver.html">Setting Up a Network Boot Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/setup_network_bootserver.html#installing-and-configuring-dhcp-and-tftp-with-dnsmasq">Installing and Configuring DHCP and TFTP with dnsmasq</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html">Build PXE Root Filesystem Image for the legacy netboot infrastructure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#pxe-client-setup-configuration">PXE Client Setup Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-client-with-remote-root">Setup Client with Remote Root</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-client-with-system-on-local-disk">Setup Client with System on Local Disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-client-with-system-on-local-md-raid-disk">Setup Client with System on Local MD RAID Disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-loading-of-custom-configuration-file-s">Setup Loading of Custom Configuration File(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-client-to-force-reload-image">Setup Client to Force Reload Image</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-client-to-force-reload-configuration-files">Setup Client to Force Reload Configuration Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-client-for-reboot-after-deployment">Setup Client for Reboot After Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-custom-kernel-boot-options">Setup custom kernel boot options</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-a-custom-boot-timeout">Setup a Custom Boot Timeout</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/legacy_netboot_root_filesystem.html#setup-a-different-download-protocol-and-server">Setup a Different Download Protocol and Server</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/network_overlay_boot.html">Booting a Root Filesystem from Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/network_live_iso_boot.html">Booting a Live ISO Image from Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/network_live_iso_boot.html#available-remote-boot-options">Available Remote Boot Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/network_live_iso_boot.html#persistent-live-system">Persistent Live System</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/custom_fstab_extension.html">Add or Update the Fstab File</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/build_with_profiles.html">Building Images with Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/build_with_profiles.html#local-builds">Local Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/build_with_profiles.html#building-with-the-open-build-service">Building with the Open Build Service</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/build_in_buildservice.html">Building in the Open Build Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/build_in_buildservice.html#advantages-of-using-the-open-build-service-obs">Advantages of using the Open Build Service (OBS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/build_in_buildservice.html#differences-between-building-locally-and-on-obs">Differences Between Building Locally and on OBS</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/build_in_buildservice.html#recommendations">Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/build_in_buildservice.html#working-with-obs">Working with OBS</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/build_in_buildservice.html#repository-configuration">Repository Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/build_in_buildservice.html#project-configuration">Project Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/use_suse_media.html">Using SUSE Product ISO To Build</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images/build_without_debianbootstrap.html">Circumvent Debian Bootstrap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/build_without_debianbootstrap.html#how-to-create-a-bootstrap-package">How to Create a bootstrap_package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing/kiwi_from_python.html">Using KIWI NG in a Python Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing/kiwi_plugin_architecture.html">Plugin Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing/kiwi_plugin_architecture.html#naming-conventions">Naming conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing/kiwi_plugin_architecture.html#example-plugin">Example plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing/scripts_testing.html">Write Integration Tests for the Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing/scripts_testing.html#test-setup">Test setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing/schema_extensions.html">Extending KIWI NG with Custom Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing/schema_extensions.html#the-extension-section">The &lt;extension&gt; Section</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing/schema_extensions.html#relax-ng-schema-for-the-extension">RELAX NG Schema for the Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing/schema_extensions.html#extension-schema-in-xml-catalog">Extension schema in XML catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing/schema_extensions.html#using-the-extension">Using the extension</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#the-basics">The Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#fork-the-upstream-repository">Fork the upstream repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#create-a-local-clone-of-the-forked-repository">Create a local clone of the forked repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#install-required-operating-system-packages">Install Required Operating System Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#create-a-python-virtual-development-environment">Create a Python Virtual Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#running-the-unit-tests">Running the Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#create-a-branch-for-each-feature-or-bugfix">Create a Branch for each Feature or Bugfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#coding-style">Coding Style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#additional-information">Additional Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#signing-git-patches">Signing Git Patches</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#bumping-the-version">Bumping the Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#creating-an-rpm-package">Creating an RPM Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="integration_testing.html">Building Build Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/kiwi.html">kiwi Package</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">KIWI NG</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Concept and Workflow</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/concept_and_workflow.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="concept-and-workflow">
<h1>Concept and Workflow<a class="headerlink" href="#concept-and-workflow" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Abstract</strong></p>
<p>The following sections describe the concept and general workflow
of building appliances with KIWI NG 10.2.42.</p>
</div>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="concept_and_workflow/systemdeps.html">Host Requirements To Build Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_and_workflow/repository_setup.html">Setting up Repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_and_workflow/packages.html">Adding and Removing Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_and_workflow/profiles.html">Image Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_and_workflow/users.html">Adding Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_and_workflow/shell_scripts.html">User-Defined Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_and_workflow/runtime_configuration.html">The Runtime Configuration File</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_and_workflow/customize_the_boot_process.html">Customizing the Boot Process</a></li>
</ul>
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>KIWI NG builds so-called <em>system images</em> (a fully installed and optionally
configured system in a single file) of a Linux distribution in two steps (for
further details, see <a class="reference internal" href="#working-with-kiwi-image-building-process"><span class="std std-ref">Image Building Process</span></a>):</p>
<ol class="arabic simple">
<li><p><em>Prepare operation</em>: generate an <em>unpacked image tree</em> of your
image. The unpacked tree is a directory containing the future filesystem
of your image, generated from your image description.</p></li>
<li><p><em>Create operation</em>: the unpacked tree generated in step 1 is packaged
into the format required for the final usage (e.g., a <code class="xref py py-obj docutils literal notranslate"><span class="pre">qcow2</span></code> disk
image to launch the image with QEMU).</p></li>
</ol>
<p>KIWI NG executes these steps using the following components, which it expects
to find in the <em>description directory</em>:</p>
<dl>
<dt><a class="reference internal" href="image_description.html#image-description"><span class="std std-ref">Image Description</span></a>:</dt><dd><p>The <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> file contains the image description, which is a
collection of general settings of the final image, like the image layout,
installed packages, present users, etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The filename <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> is not mandatory; the image description
file can also have an arbitrary name plus the <code class="file docutils literal notranslate"><span class="pre">*.kiwi</span></code> extension.
KIWI NG first looks for a <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> file. If it cannot be found,
it picks the first <code class="file docutils literal notranslate"><span class="pre">*.kiwi</span></code> file. When using a file with the
<code class="file docutils literal notranslate"><span class="pre">.kiwi</span></code> extension, multiple markup options are supported,
including <code class="xref py py-obj docutils literal notranslate"><span class="pre">XML</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">YAML</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">TOML</span></code>.</p>
</div>
</dd>
<dt><a class="reference internal" href="concept_and_workflow/shell_scripts.html#working-with-kiwi-user-defined-scripts"><span class="std std-ref">User-Defined Scripts</span></a>:</dt><dd><p>If present, custom configuration shell scripts run at different
stages of the build process. They can be used to fine-tune
the image in ways that are not possible via the settings provided in
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>.</p>
</dd>
<dt>Overlay tree directory:</dt><dd><p>The <em>overlay tree</em> is a folder (called <code class="file docutils literal notranslate"><span class="pre">root</span></code>) or a tarball
(called <code class="file docutils literal notranslate"><span class="pre">root.tar.gz</span></code>) that contains files and directories that
will be copied into the <em>unpacked image tree</em> during the <em>Prepare
operation</em>.
The copying is executed after all the packages included in
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> have been installed. Any files that are already
present will be overwritten.</p>
</dd>
<dt>CD root user data:</dt><dd><p>For live ISO images and install ISO images, an optional archive
is supported. This is a tar archive matching the name
<code class="file docutils literal notranslate"><span class="pre">config-cdroot.tar[.compression_postfix]</span></code>.</p>
<p>If present, the archive will be unpacked as user data on the ISO
image. For example, this is used to add license files or user
documentation. The documentation can then be read directly from the
CD/DVD without booting from the media.</p>
</dd>
</dl>
</section>
<section id="image-building-process">
<span id="working-with-kiwi-image-building-process"></span><h2>Image Building Process<a class="headerlink" href="#image-building-process" title="Link to this heading"></a></h2>
<figure class="align-center" id="id1">
<img alt="Kiwi NG Build Process Flow Diagram" src="_images/flow-diagram.svg" />
<figcaption>
<p><span class="caption-text">Kiwi NG Build Process Flow Diagram</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>KIWI NG creates images in a two-step process: The first step, the <em>prepare</em>
operation, generates a so-called <em>unpacked image tree</em> (directory) using
the information provided in the <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> configuration file
(see <a class="reference internal" href="image_description.html#image-description"><span class="std std-ref">Image Description</span></a>).</p>
<p>The second step, the <em>create</em> operation, creates the <em>packed image</em> or
<em>image</em> in the specified format based on the unpacked image tree and the
information provided in the <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> configuration file.</p>
<section id="the-prepare-step">
<span id="prepare-step"></span><h3>The Prepare Step<a class="headerlink" href="#the-prepare-step" title="Link to this heading"></a></h3>
<p>As the first step, KIWI NG creates an <em>unpackaged image tree</em>, also called a “root tree”. This
directory will be the installation target for software packages to be
installed during the image creation process.</p>
<p>For the package installation, KIWI NG relies on the package manager specified
in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">packagemanager</span></code> element in <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>. KIWI NG supports the
following package managers: <code class="xref py py-obj docutils literal notranslate"><span class="pre">dnf</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">zypper</span></code> (default), and <code class="xref py py-obj docutils literal notranslate"><span class="pre">apt</span></code>.</p>
<p>The prepare step consists of the following substeps:</p>
<ol class="arabic">
<li><p><strong>Create Target Root Directory</strong></p>
<p>By default, KIWI NG aborts with an error if the target root tree
already exists to avoid accidental deletion of an existing
unpacked image. The option <code class="xref py py-obj docutils literal notranslate"><span class="pre">--allow-existing-root</span></code> can be used
to work based on an existing root tree.</p>
</li>
<li><p><strong>Bootstrap Target Root Directory</strong></p>
<p>First, KIWI NG configures the package manager to use the repositories
specified in the configuration file, via the command line, or
both. After the repository setup, the packages specified in the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">bootstrap</span></code> section of the image description are installed in a
temporary directory external to the target root tree. This establishes
the initial environment to support the completion of the process in a
chroot setting. At the end of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">bootstrap</span></code> phase, the script
<code class="file docutils literal notranslate"><span class="pre">post_bootstrap.sh</span></code> is executed, if present.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The essential bootstrap packages are usually <code class="xref py py-obj docutils literal notranslate"><span class="pre">filesystem</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">glibc-locale</span></code> to specify as part of the bootstrap. The dependency
chain of these two packages is usually sufficient to populate the
bootstrap environment with all required software to support the
installation of packages into the new root tree.</p>
</div>
</li>
<li><p><strong>Install Packages</strong></p>
<p>After the <code class="xref py py-obj docutils literal notranslate"><span class="pre">bootstrap</span></code> phase, all other <code class="xref py py-obj docutils literal notranslate"><span class="pre">&lt;packages&gt;</span></code> sections are
used to complete the installation as a chroot operation. KIWI NG uses
the package manager as installed in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">bootstrap</span></code> phase and
installs all other packages as configured.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The installation of software packages through the selected package
manager may install unwanted packages. Removing these packages can be
accomplished by marking them for deletion in the image description; see
<a class="reference internal" href="concept_and_workflow/packages.html#uninstall-system-packages"><span class="std std-ref">Uninstall System Packages</span></a>.</p>
</div>
</li>
<li><p><strong>Apply the Overlay Tree</strong></p>
<p>Next, KIWI NG applies all files and directories present in the overlay
directory named <code class="file docutils literal notranslate"><span class="pre">root</span></code> or in the compressed overlay,
<code class="file docutils literal notranslate"><span class="pre">root.tar.gz</span></code>, to the target root tree. Files already present in
the target root directory are overwritten. This allows you to
overwrite any file that was installed by one of the packages during the
installation phase.</p>
</li>
<li><p><strong>Apply Archives</strong></p>
<p>All archives specified in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">archive</span></code> element of the
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> file are applied in the specified order (top to
bottom) after the overlay tree copy operation is complete (see
<a class="reference internal" href="concept_and_workflow/packages.html#archive-element"><span class="std std-ref">The archive element</span></a>). Files and directories are
extracted relative to the top level of the new root tree. As with the
overlay tree, it is possible to overwrite files already existing in the
target root tree.</p>
</li>
<li><p><strong>Execute the user-defined script</strong> <code class="file docutils literal notranslate"><span class="pre">config.sh</span></code>.</p>
<p>At the end of the preparation stage, the script <code class="file docutils literal notranslate"><span class="pre">config.sh</span></code> is
executed (if present). It is run in the top-level directory of the
target root tree. The script’s primary function is to complete the
system configuration. For more details about custom scripts,
see <a class="reference internal" href="concept_and_workflow/shell_scripts.html#working-with-kiwi-user-defined-scripts"><span class="std std-ref">User-Defined Scripts</span></a>.</p>
</li>
<li><p><strong>Modify the Root Tree</strong></p>
<p>The unpacked image tree is now finished and can be converted into the final
image in the <em>create step</em>. It is possible to make manual modifications
to the unpacked tree before it is converted into the final image.</p>
<p>Since the unpacked image tree is just a directory, it can be modified
using the standard tools. Optionally, it is also possible to ‘change
root (<code class="xref py py-obj docutils literal notranslate"><span class="pre">chroot</span></code>)’ into it, for instance, to invoke the package
manager. Besides the standard filesystem layout, the unpacked image tree
contains an additional directory named <code class="file docutils literal notranslate"><span class="pre">/image</span></code> that is not
present in a regular system. It contains information KIWI NG requires
during the create step, including a copy of the <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> file.</p>
<p>By default, KIWI NG will not stop after the <em>prepare step</em> and will
proceed directly with the <em>create step</em>. Therefore, to perform manual
modifications, proceed as follows:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kiwi-ng<span class="w"> </span>system<span class="w"> </span>prepare<span class="w"> </span><span class="nv">$ARGS</span>
<span class="gp">$ </span><span class="c1"># make your changes</span>
<span class="gp">$ </span>kiwi-ng<span class="w"> </span>system<span class="w"> </span>create<span class="w"> </span><span class="nv">$ARGS</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifications of the unpacked root tree</p>
<p>When performing manual modifications of the unpacked image tree,
be aware that these changes might be lost when calling the prepare
step again. Therefore, avoid making changes that should be
persistent across multiple runs of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare</span></code> step. The recommended
way to apply persistent changes to the unpacked image directory
is to change the original image description and re-run the <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare</span></code>
step.</p>
</div>
</li>
</ol>
</section>
<section id="the-create-step">
<span id="create-step"></span><h3>The Create Step<a class="headerlink" href="#the-create-step" title="Link to this heading"></a></h3>
<p>KIWI NG creates the final image during the <em>create step</em>: it converts the
unpacked root tree into one or multiple output files appropriate for the
respective build type.</p>
<p>It is possible to create multiple images from the same unpacked
root tree, for example, a self-installing OEM
image and a virtual machine image from the same image description. The only
prerequisite is that both image types are specified in <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>.</p>
<p>During the <em>create step</em>, the following operations are performed by KIWI NG:</p>
<ol class="arabic">
<li><p><strong>Execute the User-defined Script</strong> <code class="file docutils literal notranslate"><span class="pre">images.sh</span></code>.</p>
<p>At the beginning of the image creation process, the script named
<code class="file docutils literal notranslate"><span class="pre">images.sh</span></code> is executed (if present). For more details about
custom scripts, see <a class="reference internal" href="concept_and_workflow/shell_scripts.html#working-with-kiwi-user-defined-scripts"><span class="std std-ref">User-Defined Scripts</span></a>.</p>
</li>
<li><p><strong>Create the Requested Image Type</strong></p>
<p>KIWI NG converts the unpacked root into an output format appropriate for
the requested build type. During this process further image type
specific user defined scripts may be executed
(see <a class="reference internal" href="concept_and_workflow/shell_scripts.html#working-with-kiwi-user-defined-scripts"><span class="std std-ref">User-Defined Scripts</span></a>).</p>
</li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plugins/stackbuild.html" class="btn btn-neutral float-left" title="Building based on Containers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="concept_and_workflow/systemdeps.html" class="btn btn-neutral float-right" title="Host Requirements To Build Images" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2026, Marcus Schäfer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>